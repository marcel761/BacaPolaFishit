<!DOCTYPE html>
<html>
<head>
  <title>RNG Fish-It Simulator</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      margin: 0;
      padding: 0;
      background: #0f1724;
      color: white;
      font-family: Arial, sans-serif;
      height: 100vh;
      overflow: hidden; /* agar yang scroll hanya main */
    }

    /* HEADER FIXED */
    header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: #1e293b;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: bold;
      z-index: 10;
      border-bottom: 2px solid #334155;
    }

    /* FOOTER FIXED */
    footer {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #1e293b;
      padding: 10px;
      text-align: center;
      font-size: 13px;
      color: #cbd5e1;
      border-top: 2px solid #334155;
    }

    /* MAIN CONTENT SCROLLABLE */
    .main {
      position: absolute;
      top: 70px;       /* tinggi header */
      bottom: 50px;    /* tinggi footer */
      left: 0;
      right: 0;
      overflow-y: scroll;
      padding: 20px;
    }

    input {
      margin: 5px 0;
      padding: 8px;
      width: 95%;
      border-radius: 6px;
      border: 1px solid #333;
      background: #0b1a27;
      color: white;
      font-size: 16px;
    }

    button {
      padding: 10px 15px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin: 5px 0;
      font-weight: 700;
      width: 100%;
      font-size: 16px;
    }

    #runBtn { background:#38bdf8; color:#042033; }
    #resetBtn { background:#ef4444; color:white; }

    pre {
      background:#0b1a27;
      padding:15px;
      border-radius:10px;
      white-space: pre-wrap;
      word-wrap: break-word;
      font-size: 14px;
    }

  </style>
</head>
<body>

<!-- HEADER -->
<header>
  ðŸŽ£ RNG Fish-It Simulator
</header>

<!-- MAIN CONTENT -->
<div class="main">

  <h3>Konfigurasi</h3>

  <label>Rod Lucky (%):</label>
  <input id="rod" value="760">

  <label>Bait Lucky (%):</label>
  <input id="bait" value="320">

  <label>Jumlah mancing per run:</label>
  <input id="tries" value="500">

   <label>Lucky Bonus Manual (%):</label>
  <input id="manualLucky" value="0">
  
  <button id="runBtn" onclick="simulate()">â–¶ Jalankan Simulasi</button>
  <button id="resetBtn" onclick="resetAll()">ðŸ”„ Reset</button>

  <pre id="output"></pre>

</div>

<!-- FOOTER -->
<footer>
  Â© 2025 â€¢ Fish-It RNG Simulator Mobile
</footer>

<script>
let pity = 0;
let totalMancing = 0;
let counts = {};
let initialized = false;
let runNumber = 0;

let historyLogs = [];

let baseRarity = {
  "Common":    0.75,
  "Uncommon":  0.15,
  "Rare":      0.06,
  "Epic":      0.025,
  "Legendary": 0.008,
  "Mythic":    0.0008,
  "Secret":    1 / 4000000
};

function initCounters(){
  for (let r in baseRarity) counts[r] = 0;
  initialized = true;
}

function getAdjustedRarity() {
  let rod = parseFloat(document.getElementById("rod").value);
  let bait = parseFloat(document.getElementById("bait").value);
  let manualLucky = parseFloat(document.getElementById("manualLucky").value);

  // Lucky multiplier â†’ DILEMAHKAN agar tidak terlalu kuat
  // Semua lucky dihitung lebih kecil (mirip game aslinya)
  let luckyMultiplier = 1 + (rod + bait + manualLucky) / 20000;

  // pity tetap mempengaruhi secret
  let pityBonus = pity;

  let adjusted = {};
  for (let r in baseRarity) {
    adjusted[r] = baseRarity[r] * luckyMultiplier;
  }

  // secret khusus â†’ multiplier kecil + pity
  adjusted["Secret"] = baseRarity["Secret"] * luckyMultiplier + pityBonus;

  // Normalisasi
  let sum = Object.values(adjusted).reduce((a,b)=>a+b, 0);
  for (let r in adjusted) adjusted[r] /= sum;

  return adjusted;
}


function rollRarity(adjusted){
  let x = Math.random();
  let acc = 0;
  for (let r in adjusted) {
    acc += adjusted[r];
    if (x <= acc) return r;
  }
  return "Common";
}

function simulate() {

  if (!initialized) initCounters();

  let tries = parseInt(document.getElementById("tries").value);
  totalMancing += tries;

  let localCount = {};
  for (let r in baseRarity) localCount[r] = 0;

  for (let i=0; i<tries; i++) {
    let adjusted = getAdjustedRarity();
    let r = rollRarity(adjusted);

    counts[r]++;
    localCount[r]++;

    if (r !== "Secret") pity += 0.00000003;
    else pity = 0;
  }

  runNumber++;
  saveHistory(runNumber, tries, localCount);
  updateOutput();
}

function saveHistory(run, tries, localCount){
  let logText = 
`RUN #${run}
Jumlah: ${tries}
Common: ${localCount.Common}
Uncommon: ${localCount.Uncommon}
Rare: ${localCount.Rare}
Epic: ${localCount.Epic}
Legendary: ${localCount.Legendary}
Mythic: ${localCount.Mythic}
Secret: ${localCount.Secret}
-----------------------------`;

  historyLogs.push(logText);
}

function updateOutput(){

  let t = "=== TOTAL AKUMULASI ===\n";
  t += `Total Mancing: ${totalMancing}\n`;
  t += `Pity Saat Ini: ${pity.toFixed(10)}\n\n`;

  for (let r in counts) t += `${r}: ${counts[r]}\n`;

  t += `\n\n=== HISTORY PER RUN ===\n\n`;
  historyLogs.forEach(log => t += log + "\n");

  document.getElementById("output").textContent = t;
}

function resetAll(){
  pity = 0;
  totalMancing = 0;
  runNumber = 0;
  historyLogs = [];
  initCounters();

  document.getElementById("output").textContent = "Semua data telah direset.\n";
}
</script>

</body>
</html>
