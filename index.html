<!DOCTYPE html>
<html>
<head>
  <title>RNG Fish-It Simulator</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      margin: 0;
      padding: 0;
      background: #0f1724;
      color: white;
      font-family: Arial, sans-serif;
      height: 100vh;
      overflow: hidden;
    }

    header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: #1e293b;
      padding: 15px;
      text-align: center;
      font-size: 20px;
      font-weight: bold;
      z-index: 10;
      border-bottom: 2px solid #334155;
      box-shadow: 0 2px 8px rgba(0,0,0,0.4);
    }

    footer {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #1e293b;
      padding: 10px;
      text-align: center;
      font-size: 13px;
      color: #cbd5e1;
      border-top: 2px solid #334155;
      box-shadow: 0 -2px 8px rgba(0,0,0,0.4);
    }

    .main {
      position: absolute;
      top: 70px;
      bottom: 55px;
      left: 0;
      right: 0;
      overflow-y: auto;
      padding: 18px;
    }

    h3 {
      margin-bottom: 10px;
      margin-top: 0;
    }

    label {
      display: block;
      margin-top: 10px;
      margin-bottom: 5px;
      font-size: 15px;
      color: #e2e8f0;
      font-weight: 600;
    }

    input, select {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #334155;
      background: #0b1a27;
      color: white;
      font-size: 16px;
      outline: none;
      box-sizing: border-box;
    }

    button {
      padding: 12px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      margin-top: 12px;
      font-weight: bold;
      width: 100%;
      font-size: 17px;
      transition: 0.15s;
    }

    #runBtn {
      background: #38bdf8;
      color: #042033;
    }
    #runBtn:active { transform: scale(0.97); }

    #resetBtn {
      background: #ef4444;
      color: white;
    }
    #resetBtn:active { transform: scale(0.97); }

    pre {
      background: #0b1a27;
      padding: 18px;
      border-radius: 12px;
      white-space: pre-wrap;
      font-size: 14px;
      margin-top: 20px;
      border: 1px solid #1e293b;
      box-shadow: inset 0 0 10px rgba(0,0,0,0.35);
    }
  </style>
</head>
<body>

<header>ðŸŽ£ Cari Pola Fish-It</header>

<div class="main">

  <h3>Konfigurasi Simulator</h3>

  <label>Rod Lucky (%):</label>
  <input id="rod" value="760">

  <label>Bobbers Lucky (%):</label>
  <input id="bait" value="320">

  <label>Enchanted 1:</label>
  <select id="ench1">
    <option value="0">Tidak dipakai</option>
    <option value="50">Leprechaun II (+50%)</option>
    <option value="30">Leprechaun I (+30%)</option>
    <option value="20">Empowered I (+20%)</option>
    <option value="-75">Cursed I (-75%)</option>
    <option value="10">Prismatic I (+10%)</option>
    <option value="80">Stromhunter (+80% saat badai)</option>
    <option value="60">Stargazer (+60% saat malam)</option>
    <option value="0">Big Hunter I</option>
    <option value="0">Mutation Hunter II</option>
    <option value="0">Glistening</option>
    <option value="0">Gold Digger</option>
    <option value="0">Reeler</option>
    <option value="0">Xperienced</option>
  </select>

  <label>Enchanted 2:</label>
  <select id="ench2">
    <option value="0">Tidak dipakai</option>
    <option value="50">Leprechaun II (+50%)</option>
    <option value="30">Leprechaun I (+30%)</option>
    <option value="20">Empowered I (+20%)</option>
    <option value="-75">Cursed I (-75%)</option>
    <option value="10">Prismatic I (+10%)</option>
    <option value="80">Stromhunter (+80% saat badai)</option>
    <option value="60">Stargazer (+60% saat malam)</option>
    <option value="0">Big Hunter I</option>
    <option value="0">Mutation Hunter II</option>
    <option value="0">Glistening</option>
    <option value="0">Gold Digger</option>
    <option value="0">Reeler</option>
    <option value="0">Xperienced</option>
  </select>

  <label>Manual Lucky Bonus (%):</label>
  <input id="manualLucky" value="0">

  <label>Jumlah mancing per run:</label>
  <input id="tries" value="500">

  <button id="runBtn" onclick="simulate()">â–¶ Jalankan Simulasi</button>
  <button id="resetBtn" onclick="resetAll()">ðŸ”„ Reset</button>

  <pre id="output"></pre>

</div>

<footer>Â© 2025 â€¢ Goretzkaa15</footer>

<script>
let pity = 0;
let totalMancing = 0;
let counts = {};
let initialized = false;
let runNumber = 0;
let historyLogs = [];

let baseRarity = {
  "Common":    0.75,
  "Uncommon":  0.15,
  "Rare":      0.06,
  "Epic":      0.025,
  "Legendary": 0.008,
  "Mythic":    0.0008,
  "Secret":    1 / 4000000
};

// FIXED â€” function yg hilang tadi
function initCounters() {
  counts = {};
  for (let r in baseRarity) {
    counts[r] = 0;
  }
  initialized = true;
}

function getAdjustedRarity() {
  let rod = parseFloat(document.getElementById("rod").value);
  let bait = parseFloat(document.getElementById("bait").value);
  let manualLucky = parseFloat(document.getElementById("manualLucky").value);
  let ench1 = parseFloat(document.getElementById("ench1").value);
  let ench2 = parseFloat(document.getElementById("ench2").value);

  let totalLucky = rod + bait + manualLucky + ench1 + ench2;
  let luckyMultiplier = 1 + totalLucky / 20000;

  let pityBonus = pity;
  let adjusted = {};

  for (let r in baseRarity)
    adjusted[r] = baseRarity[r] * luckyMultiplier;

  adjusted["Secret"] = baseRarity["Secret"] * luckyMultiplier + pityBonus;

  let sum = Object.values(adjusted).reduce((a,b)=>a+b, 0);
  for (let r in adjusted) adjusted[r] /= sum;

  return adjusted;
}

function rollRarity(adjusted){
  let x = Math.random();
  let acc = 0;
  for (let r in adjusted) {
    acc += adjusted[r];
    if (x <= acc) return r;
  }
  return "Common";
}

function simulate() {
  if (!initialized) initCounters();

  let tries = parseInt(document.getElementById("tries").value);
  totalMancing += tries;

  let localCount = {};
  for (let r in baseRarity) localCount[r] = 0;

  for (let i=0; i<tries; i++) {
    let adjusted = getAdjustedRarity();
    let r = rollRarity(adjusted);

    counts[r]++;
    localCount[r]++;

    if (r !== "Secret") pity += 0.00000003;
    else pity = 0;
  }

  runNumber++;
  saveHistory(runNumber, tries, localCount);
  updateOutput();
}

function saveHistory(run, tries, localCount){
  let logText =
`RUN #${run}
Jumlah: ${tries}
Common: ${localCount.Common}
Uncommon: ${localCount.Uncommon}
Rare: ${localCount.Rare}
Epic: ${localCount.Epic}
Legendary: ${localCount.Legendary}
Mythic: ${localCount.Mythic}
Secret: ${localCount.Secret}
-----------------------------`;

  historyLogs.push(logText);
}

function updateOutput(){
  let t = "=== TOTAL AKUMULASI ===\n";
  t += `Total Mancing: ${totalMancing}\n`;
  t += `Pity Saat Ini: ${pity.toFixed(10)}\n\n`;

  for (let r in counts) t += `${r}: ${counts[r]}\n`;

  t += `\n\n=== HISTORY PER RUN ===\n\n`;
  historyLogs.forEach(log => t += log + "\n");

  document.getElementById("output").textContent = t;
}

function resetAll(){
  pity = 0;
  totalMancing = 0;
  runNumber = 0;
  historyLogs = [];
  initCounters();

  document.getElementById("output").textContent = "Semua data telah direset.\n";
}
</script>

</body>
</html>
